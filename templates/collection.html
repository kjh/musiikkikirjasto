<!DOCTYPE html>
<html>

<head>
  <title>{{ collection.title }} - {{ collection.username }} </title>
</head>

<body>
  <h1>{{ collection.title }} owner: {{ collection.username }} like count: {{ like_count }}</h1>
  <p> Tags:
  {% for tag in tags %}
  
  {{ tag.name }}{% if not loop.last %}, {% endif %}

  {% endfor %}
  <p>

  <hr />
  {% for release in releases %}
  <p id="{{ release.id }}">
    {{ release.username }} ({{ release.sent_at }}):
  </p>
  <p>
    {{ release.artist }}
  </p>
  <p>
    {{ release.title }}
  </p>
  {% if release.user_id == session.user_id %}
  <p>
    <a href="/edit/{{ release.id }}">Muokkaa</a> |
    <a href="/remove/{{ release.id }}">Poista</a>
  </p>
  {% endif %}
  <hr />
  {% endfor %}
  
  {% if session.user_id and collection.user_id == session.user_id %}
  <h2>Uusi julkaisu</h2>

  <form action="/new_release" method="post">
    <p>
      Artisti:<br />
      <input type="text" name="artist" maxlength="100" size="40" required />
    </p>
    <p>
      Julkaisun nimi:<br />
      <input type="text" name="title" maxlength="100" size="40" required />
    </p>
    <input type="hidden" name="collection_id" value="{{ collection.id }}" />
    <input type="submit" value="Lähetä" />
  </form>
  
  <form action="/add_tags" method="post">
    <p>
      Lisää tagit:<br />
      <input type="text" name="tags" maxlength="100" size="40" required />
    </p>
    <input type="hidden" name="collection_id" value="{{ collection.id }}" />
    <input type="submit" value="Lisää" />
  </form>
  <hr />
  {% endif %}

  {% if session.user_id and collection.user_id != session.user_id and not has_liked %}
  <form action="/like_collection" method="post">
    <input type="hidden" name="collection_id" value="{{ collection.id }}" />
    <input type="hidden" name="user_id" value="{{ session.user_id }}" />
    <input type="submit" value="like" />
  </form>
  <hr />
  {% elif session.user_id and collection.user_id != session.user_id and has_liked %}
  <form action="/delete_like_collection" method="post">
    <input type="hidden" name="collection_id" value="{{ collection.id }}" />
    <input type="hidden" name="user_id" value="{{ session.user_id }}" />
    <input type="submit" value="remove like" />
  </form>
  <hr />
  {% endif %}

  <p>
    <a href="/">Etusivulle</a>
  </p>
</body>

</html>
